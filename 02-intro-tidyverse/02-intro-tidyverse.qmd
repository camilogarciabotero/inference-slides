---
title: An introduction to the Tidyverse
subtitle: "https://bit.ly/3LWSBQK"
author:
  - name: Camilo G.
    email: ca.garcia2@uniandes.edu.co

  - name: "Kevin J."
    email: d.vivasb@uniandes.edu.co

  - name: "Victor A."
    email: v.nascimento@uniandes.edu.co
format:
  revealjs:
    footer: |
      BIOL2205 - Inferencia e Inform√°tica - Uniandes
    standalone: true
    preview-links: auto
    center: true
    slide-number: true
    fig-align: center
    code-line-numbers: false`
    overview: true
    code-link: true
    code-annotations: hover
    highlight-style: ayu
    df-print: paged
    scrollable: true
    fig-height: 8
    fig-width: 8
    fig-dpi: 320
    theme: ../theme.scss
    bibliography: ../references.bib
---

```{r}
#| label: theme-set
#| eval: true
library(tidyverse)
library(palmerpenguins)

simple_theme <- theme_bw() +
    theme(
        plot.background = element_rect(fill = "#FDF6E3"),
        panel.background = element_rect(fill = "#FDF6E3"),
        legend.background = element_rect(fill = "#FDF6E3"),
        legend.position = "top",
        axis.title = element_text(size = 14)
    )

theme_set(simple_theme)
```

# (Un)Tidy data - a horror story^[A story from @broman2018data]

## 1. Empty cells

![](figs/empty-cells-data.png){fig-align="center" width="500"}

## 2. Inconsistency

![](figs/inconsistency-data.png){fig-align="center" width="500"}

## 3. Complicated layout

![](figs/complicated-layout.png){fig-align="center" width="600"}

## 4. Multiple id-row

![](figs/multi-id-data.png){fig-align="center" width="600"}

## 6. Summaries

![](figs/summary-data.png){fig-align="center" width="600"}

## 7. True Horror data

![Horror data](figs/horror-data.png){fig-align="center" width="700"}

# A Tidy data set

![Tidy data](figs/tidy-data.png){fig-align="center" width="800"}

------------------------------------------------------------------------

![Tidy data principles. Fuente: https://r4ds.had.co.nz/tidy-data.html](https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/91adc/images/tidy-1.png){fig-align="center"}

------------------------------------------------------------------------

![Make friends with tidy data](figs/tidy-data-cartoon.png)

# The Tidyverse

***

![](figs/tidyverse-hexlogo.png){fig-align="center" width="800"}

***

![](figs/tidy-process.png){fig-align="center" width="800"}

***

![](figs/tidy-ecosystem.png){fig-align="center" width="800"}



# Manipulating data with the Tidyverse

## The Palmer Penguins Data Set

![](figs/palmer-penguins.png)

***

![](figs/penguines-measures.png)

***

Importing libraries:
```{r}
#| label: libraries
#| echo: true
#| 
library(tidyverse)
library(palmerpenguins)
```

***

## Data wrangling and cleaning {.smaller }

![](figs/data-wrangling-transparent.png){fig-align="center" width="500"}

***
:::{.incremental}
- `filter()` : it *filters* the observations *(rows)* by satisfying a criterion
- `mutate()` : creates a new variable (column) based on existing variables.
- `select()`: selects variables *(columns)*
- `group_by()`: groups observations according to the categories of a variable.
- `drop_na()`: gets rid of NA values in the entire dataset or in certain variables.
- `summarise()`: reduces multiple values to a single value based on an operation (e.g. `mean()`)
:::

***

A common set of operation are written as:

```{.r}
tibble |> 
  function |> 
  function ...
```
## Let's try them out

What are the max and min body sizes for Adelie and Gentoo penguins?

##  {auto-animate="true"}

```{r}
#| label: 00-data
#| echo: true
#| eval: true
#| fig-align: center
penguins
```


##  {auto-animate="true"}

```{r}
#| label: 01-data
#| echo: true
#| eval: true
#| fig-align: center
penguins |> 
  filter(species == "Adelie" | species == "Gentoo")
```

##  {auto-animate="true"}

```{r}
#| label: 02-data
#| echo: true
#| eval: true
#| fig-align: center
penguins |> 
  filter(species ==  "Adelie" | species == "Gentoo") |>
  select(species, body_mass_g)
```

##  {auto-animate="true"}

```{r}
#| label: 03-data
#| echo: true
#| eval: true
#| fig-align: center
penguins |> 
  filter(species == "Adelie" | species == "Gentoo") |>
  select(species, body_mass_g) |>
  group_by(species) 
```


##  {auto-animate="true"}

```{r}
#| label: 04-data
#| echo: true
#| eval: true
#| fig-align: center
penguins |> 
  filter(species == "Adelie" | species == "Gentoo") |>
  select(species, body_mass_g) |>
  group_by(species) |> 
  drop_na(body_mass_g)
```

##  {auto-animate="true"}

```{r}
#| label: 05-data
#| echo: true
#| eval: true
#| fig-align: center
penguins |> 
  filter(species == "Adelie" | species == "Gentoo") |>
  select(species, body_mass_g) |>
  group_by(species) |> 
  drop_na(body_mass_g) |> 
  summarise(max_weight_g = max(body_mass_g), min_weight_g = min(body_mass_g))
```

##  {auto-animate="true"}

```{r}
#| label: 06-data
#| echo: true
#| eval: true
#| fig-align: center
penguins |> 
  filter(species == "Adelie" | species == "Gentoo") |>
  select(species, body_mass_g) |>
  group_by(species) |> 
  drop_na(body_mass_g) |> 
  summarise(max_weight_g = max(body_mass_g), min_weight_g = min(body_mass_g)) |>
  mutate(max_wight_kg = max_weight_g/1000)
```


# Data visualization with `ggplot2`

***

![](figs/ggplot-layers.png){fig-align="center"}

***

![](figs/ggplot-skeleton.png){fig-align="center"}

***

Importing libraries:
```{r}
#| echo: true
library(ggplot2)
library(palmerpenguins)
```

***

```{r}
#| label: full-plot
#| echo: true
#| eval: true
#| fig-align: center
#| output-location: default
#| code-fold: true
ggplot(
    data = penguins,
    aes(
        x = flipper_length_mm,
        y = bill_length_mm
    )
) +
  geom_point(
      aes(
          color = species,
          shape = species
      ),
      size = 3,
      alpha = 0.8
  ) +
  scale_color_manual(values = c("darkorange", "purple", "cyan4")) +
  labs(
      title = "Flipper and bill length",
      subtitle = "Dimensions for Adelie, Chinstrap and Gentoo Penguins at Palmer Station LTER",
      x = "Flipper length (mm)",
      y = "Bill length (mm)",
      color = "Penguin species",
      shape = "Penguin species"
  ) +
  theme(
      legend.position = c(0.85, 0.15),
      plot.title.position = "plot",
      plot.caption = element_text(hjust = 0, face = "italic"),
      plot.caption.position = "plot"
  )
```

##  {auto-animate="true"}

```{r}
#| label: 00-plot
#| echo: true
#| eval: true
#| fig-align: center
#| output-location: column-fragment
#| code-line-numbers: "1-6"
ggplot(data = penguins,
    aes(
        x = flipper_length_mm,
        y = bill_length_mm
    )
)
```

##  {auto-animate="true"}

```{r}
#| label: 01-plot
#| echo: true
#| eval: true
#| fig-align: center
#| output-location: column
#| code-line-numbers: "7-12"
ggplot(data = penguins,
    aes(
        x = flipper_length_mm,
        y = bill_length_mm
    )
) +
  geom_point(
      aes(
          color = species,
          shape = species
      )
  )
```

##  {auto-animate="true"}

```{r}
#| label: 02-plot
#| echo: true
#| eval: true
#| fig-align: center
#| output-location: column
#| code-line-numbers: "13-19"
ggplot(data = penguins,
    aes(
        x = flipper_length_mm,
        y = bill_length_mm
    )
) +
  geom_point(
      aes(
          color = species,
          shape = species
      )
  ) +
  scale_color_manual(
    values = c(
      "darkorange", 
      "purple",
      "cyan4"
      )
  )
```

##  {auto-animate="true"}

```{r}
#| label: 03-plot
#| echo: true
#| eval: true
#| fig-align: center
#| output-location: column
#| code-line-numbers: "20-28"
ggplot(data = penguins,
    aes(
        x = flipper_length_mm,
        y = bill_length_mm
    )
) +
  geom_point(
      aes(
          color = species,
          shape = species
      )
  ) +
  scale_color_manual(
    values = c(
      "darkorange", 
      "purple",
      "cyan4"
      )
  ) +
  labs(
      title = "Flipper and bill length",
      subtitle = "Dimensions for Adelie, Chinstrap and Gentoo Penguins at Palmer Station LTER",
      x = "Flipper length (mm)",
      y = "Bill length (mm)",
      color = "Penguin species",
      shape = "Penguin species"
  )
```


***

![](figs/ggplot-geoms-cartoon.png){fig-align="center"}

***

![](figs/ggplot-theme-reference.png){fig-align="center"}

***

![visit in https://exts.ggplot2.tidyverse.org/gallery/](figs/ggplot-gallery.png){fig-align="center"}

## References


